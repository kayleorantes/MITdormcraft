---
timestamp: 'Sun Oct 19 2025 03:59:30 GMT-0400 (Eastern Daylight Time)'
content_id: bb5289b4fa2faca2c177e4a6a54985f509d56c9e577b60edc75217412b8c2479
---

# file: src/concepts/user.ts

```typescript
import { Collection, Db, ObjectId } from "npm:mongodb";

// --- Type Definitions ---

/**
 * Represents a User document in the database.
 * This interface matches the 'state' defined in the User concept.
 */
export interface User {
  _id: ObjectId;
  username: string;
  mitKerberos: string;
  bio: string;
  createdAt: Date;
}

// --- Concept Implementation ---

/**
 * Implements the User concept.
 * Manages user profile data, but NOT authentication.
 */
export class UserConcept {
  private readonly users: Collection<User>;

  constructor(db: Db) {
    this.users = db.collection<User>("users");
  }

  /**
   * Retrieves a user by their unique ID.
   * Corresponds to the `getUser` action.
   */
  async getUser(userID: string): Promise<User | null> {
    // Validate that the userID is a valid MongoDB ObjectId
    if (!ObjectId.isValid(userID)) {
      return null;
    }
    return await this.users.findOne({ _id: new ObjectId(userID) });
  }

  /**
   * Retrieves a user by their public, unique username.
   * Corresponds to the `getUserByUsername` action.
   */
  async getUserByUsername(username: string): Promise<User | null> {
    // Find user by the 'username' field
    return await this.users.findOne({ username });
  }

  /**
   * Updates a user's profile biography.
   * Corresponds to the `updateUserProfile` action.
   */
  async updateUserProfile(userID: string, bio: string): Promise<boolean> {
    if (!ObjectId.isValid(userID)) {
      return false;
    }

    // Update only the 'bio' field
    const result = await this.users.updateOne(
      { _id: new ObjectId(userID) },
      { $set: { bio: bio } },
    );

    // Return true if exactly one document was modified
    return result.modifiedCount === 1;
  }

  // Note: `createUser` is intentionally omitted.
  // As per the design notes, user creation is handled by the
  // `AuthenticationConcept` to ensure separation of concerns.
}

```
